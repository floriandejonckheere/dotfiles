#!/usr/bin/env zsh

# Configure a patient machine identifier (default patient: Frank Augustinus)
function nf_identifier() {
  PATIENT=${1:-"Frank Augustinus"}
  IDENTIFIER=${2:-"4A0312620B59"}
  OPTIONS=(${@:3})

  # Sign in as administrator
  nf_signin nephroflow admin &> /dev/null

  # Enable patient cards
  ID=$(nf_get /api/configurations | jq '.configurations[] | select(.key=="patient.cards") | .id')
  nf_patch "/api/configurations/${ID}" "{\"configuration\":{\"value\":\"true\"}}"

  # curl 'http://localhost:8080/api/patients/d817048b-8f0e-4fdf-b049-ffd5601062aa/cards' \
      #  -H 'Accept: application/json, text/plain, */*' \
      #  -H 'Accept-Language: en-US,en' \
      #  -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJleHAiOjE3MzY4NTg0MTEsImF1ZCI6Im5lcGhyb2Zsb3ctY2xpZW50cyIsImlzcyI6Imh0dHBzOi8vZGV2Lm9ubmVwaHJvZmxvdy5jb20iLCJzdWIiOiI1MDRkNDU3MS05YzZhLTQzMTUtYTM3ZC0zMjJkNjBhYTMzNGYiLCJpYXQiOjE3MzY4NTQ4MTEsInVpZCI6IjQ1ZDkyYzcxLTg4ODItNDMzMS1hNmU5LTcwNWRhYjU2NWZkMiJ9.5f0ESI0cWC4Cs7LMIrEY6Ud88fZb9SZYtzfcMoCo1QM' \
      #  -H 'Connection: keep-alive' \
      #  -H 'Cookie: __profilin=p%3Dt; _interslice_session=8Ol4w1yWrDYFKwZN%2FxTJ0Dp%2BI5ErblmzF5TTSaAo%2BM5A9DPpXH0yAnq%2Bn2GYm4ldtNVpPbe8w8%2BNI78e5TjezBo8ZVBqMRRM77E2sj2Fl48oEPmP5Wgg3wK8m5R9jCvDTxDQmQ84WA2O9K4PBBi6Q2m3FS600NHEWzyVvvYIkVWv8LLXd8ctK8qm9Bi5nNLijWCswBHiWIXR7Q5%2F03MmeOM2bAmt81%2FiJIc4hxW2oG9UZscNgOOF7erFLx5G9Y5mrO13dEw1aflQRKkI2ipjDLe8kg%3D%3D--RhJ0P3X1oazinOfN--mGe4AJl4oGxGtyOFyqxWmw%3D%3D' \
      #  -H 'Referer: http://localhost:8080/patients/d817048b-8f0e-4fdf-b049-ffd5601062aa/basic_info/patient_cards' \
      #  -H 'Sec-Fetch-Dest: empty' \
      #  -H 'Sec-Fetch-Mode: cors' \
      #  -H 'Sec-Fetch-Site: same-origin' \
      #  -H 'Sec-GPC: 1' \
      #  -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36' \
      #  -H 'X-User-Timezone: Europe/Brussels' \
      #  -H 'dnt: 1' \
      #  -H 'sec-ch-ua: "Brave";v="131", "Chromium";v="131", "Not_A Brand";v="24"' \
      #  -H 'sec-ch-ua-mobile: ?0' \
      #  -H 'sec-ch-ua-platform: "macOS"'
}
